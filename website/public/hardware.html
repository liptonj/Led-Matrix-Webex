<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Guide - LED Matrix Webex Display</title>
    <link rel="stylesheet" href="css/style.css">
    <meta name="description" content="Complete hardware guide for building an LED Matrix Webex Status Display with ESP32/ESP32-S3">
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
</head>
<body>
    <header>
        <div class="container">
            <h1>üì¶ Hardware Guide</h1>
            <p class="tagline">Build your LED Matrix Webex Display</p>
            <div class="header-actions">
                <button class="theme-toggle" type="button" aria-pressed="false">Theme: Light</button>
            </div>
        </div>
    </header>

    <main class="container">
        <section>
            <h2>Required Components</h2>
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Specification</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>LED Matrix Panel</td>
                        <td>P3 Indoor 64√ó32 RGB, HUB75 interface</td>
                        <td><strong>Must have FM6126A driver chip</strong></td>
                    </tr>
                    <tr>
                        <td>Microcontroller</td>
                        <td>ESP32-S3-DevKitC-1-N8R2</td>
                        <td>ESP32-S3 recommended (ESP32 also supported)</td>
                    </tr>
                    <tr>
                        <td>Power Supply</td>
                        <td>5V DC, 2.5-4A</td>
                        <td>Matrix requires dedicated power supply</td>
                    </tr>
                    <tr>
                        <td>Wiring</td>
                        <td>HUB75 ribbon cable + jumper wires</td>
                        <td>16-pin 2.54mm pitch IDC connector</td>
                    </tr>
                </tbody>
            </table>

            <div class="alert alert-warning">
                <h4>‚ö†Ô∏è Critical: FM6126A Driver Required</h4>
                <p>The firmware is configured specifically for LED matrix panels with the <strong>FM6126A driver chip</strong>. Panels with other drivers (ICN2038S, FM6124, etc.) may display incorrectly or not work at all. Always verify your panel has the FM6126A driver before purchasing.</p>
            </div>
        </section>

        <section>
            <h2>LED Matrix Specifications</h2>
            <div class="card">
                <h3>P3 Indoor RGB LED Matrix Panel</h3>
                <ul>
                    <li><strong>Resolution:</strong> 64√ó32 pixels (2,048 individual RGB LEDs)</li>
                    <li><strong>Physical Size:</strong> 192mm √ó 96mm (7.6" √ó 3.8")</li>
                    <li><strong>Pixel Pitch:</strong> 3mm (P3)</li>
                    <li><strong>Interface:</strong> HUB75 (16-pin IDC)</li>
                    <li><strong>Driver Chip:</strong> FM6126A (REQUIRED)</li>
                    <li><strong>Scan Mode:</strong> 1/16 scan</li>
                    <li><strong>Power:</strong> 5V DC, ~2.5A at full brightness</li>
                    <li><strong>Viewing Angle:</strong> 140¬∞ horizontal, 140¬∞ vertical</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>ESP32-S3 Pin Mapping</h2>
            <p>The following pin configuration is used in the firmware (verified from <code>matrix_display.cpp</code>):</p>
            
            <table>
                <thead>
                    <tr>
                        <th>HUB75 Pin</th>
                        <th>Function</th>
                        <th>ESP32-S3 GPIO</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>R1</td><td>Red Upper</td><td>GPIO 37</td><td>Red data for upper half of panel</td></tr>
                    <tr><td>G1</td><td>Green Upper</td><td>GPIO 6</td><td>Green data for upper half</td></tr>
                    <tr><td>B1</td><td>Blue Upper</td><td>GPIO 36</td><td>Blue data for upper half</td></tr>
                    <tr><td>R2</td><td>Red Lower</td><td>GPIO 35</td><td>Red data for lower half of panel</td></tr>
                    <tr><td>G2</td><td>Green Lower</td><td>GPIO 5</td><td>Green data for lower half</td></tr>
                    <tr><td>B2</td><td>Blue Lower</td><td>GPIO 0</td><td>Blue data for lower half</td></tr>
                    <tr><td>A</td><td>Row Select A</td><td>GPIO 45</td><td>Row address line A</td></tr>
                    <tr><td>B</td><td>Row Select B</td><td>GPIO 1</td><td>Row address line B</td></tr>
                    <tr><td>C</td><td>Row Select C</td><td>GPIO 48</td><td>Row address line C</td></tr>
                    <tr><td>D</td><td>Row Select D</td><td>GPIO 2</td><td>Row address line D</td></tr>
                    <tr><td>E</td><td>Row Select E</td><td>GPIO 4</td><td>Row address line E (for 1/32 scan)</td></tr>
                    <tr><td>CLK</td><td>Clock</td><td>GPIO 47</td><td>Shift register clock</td></tr>
                    <tr><td>LAT</td><td>Latch</td><td>GPIO 38</td><td>Latch/strobe signal</td></tr>
                    <tr><td>OE</td><td>Output Enable</td><td>GPIO 21</td><td>Output enable (active low)</td></tr>
                    <tr><td>GND</td><td>Ground</td><td>GND</td><td>Connect all GND pins</td></tr>
                </tbody>
            </table>

            <p><strong>Note:</strong> ESP32 (non-S3) uses different GPIO pins. See the <code>matrix_display.cpp</code> file for ESP32 pin mappings.</p>
        </section>

        <section>
            <h2>HUB75 Connector Pinout</h2>
            <p>Looking at the matrix from the <strong>back</strong> (connector side), the HUB75 socket is arranged as:</p>
            
            <div class="code-block">
                <code style="font-family: monospace; white-space: pre;">
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇR1 ‚îÇG1 ‚îÇB1 ‚îÇGND‚îÇR2 ‚îÇG2 ‚îÇB2 ‚îÇGND‚îÇ  ‚Üê Top row (odd pins: 1,3,5,7,9,11,13,15)
‚îú‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚î§
‚îÇ A ‚îÇ B ‚îÇ C ‚îÇ D ‚îÇCLK‚îÇLAT‚îÇOE ‚îÇ E ‚îÇ  ‚Üê Bottom row (even pins: 2,4,6,8,10,12,14,16)
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
  1   3   5   7   9  11  13  15
  2   4   6   8  10  12  14  16
                </code>
            </div>

            <div class="alert alert-warning">
                <p><strong>‚ö†Ô∏è Warning:</strong> The HUB75 connector is NOT keyed. Double-check pin 1 alignment before connecting power!</p>
            </div>
        </section>

        <section>
            <h2>Critical Firmware Configuration</h2>
            <p>The firmware uses the following driver settings (from <code>matrix_display.cpp</code>):</p>

            <div class="code-block">
                <code>
// Panel driver configuration<br>
mxconfig.driver = HUB75_I2S_CFG::FM6126A;  // REQUIRED for P3 panels<br>
mxconfig.clkphase = false;                 // CRITICAL: Must be false<br>
mxconfig.i2sspeed = HUB75_I2S_CFG::HZ_20M; // 20MHz for stability<br>
mxconfig.min_refresh_rate = 120;           // Reduce visible flicker<br>
mxconfig.latch_blanking = 1;               // Stable latch timing
                </code>
            </div>

            <div class="alert alert-info">
                <p><strong>Why these settings matter:</strong></p>
                <ul>
                    <li><strong>FM6126A driver:</strong> Enables proper initialization sequence for this chip</li>
                    <li><strong>clkphase = false:</strong> Critical timing for FM6126A. <code>true</code> causes display corruption</li>
                    <li><strong>HZ_20M:</strong> 20MHz I2S speed balances refresh rate and stability</li>
                    <li><strong>min_refresh_rate = 120:</strong> Reduces visible flickering</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>Library Dependencies</h2>
            <p>The project uses the following libraries (from <code>platformio.ini</code>):</p>
            <ul>
                <li><strong>ESP32-HUB75-MatrixPanel-I2S-DMA</strong> v3.0.0 - LED matrix driver with DMA</li>
                <li><strong>Adafruit GFX Library</strong> v1.11.0 - Graphics primitives</li>
                <li><strong>ArduinoJson</strong> v7.0.0 - JSON parsing</li>
                <li><strong>ESPAsyncWebServer</strong> v1.2.3 - Async web server</li>
                <li><strong>WebSockets</strong> v2.4.0 - WebSocket client for Webex</li>
            </ul>
        </section>

        <section>
            <h2>Power Requirements</h2>
            <div class="card">
                <h3>‚ö° Power Supply Guidelines</h3>
                <ul>
                    <li><strong>Minimum:</strong> 5V @ 2.5A (for testing at reduced brightness)</li>
                    <li><strong>Recommended:</strong> 5V @ 4A (for full brightness white display)</li>
                    <li><strong>Maximum Draw:</strong> ~15-20W at 100% brightness, all LEDs white</li>
                    <li><strong>Typical Usage:</strong> ~8-12W with status displays</li>
                </ul>

                <p><strong>‚ö†Ô∏è Important:</strong> The ESP32 USB port cannot power the matrix. Use a dedicated 5V power supply connected directly to the matrix power input (red/black wires or barrel jack).</p>
            </div>
        </section>

        <section>
            <h2>Assembly Steps</h2>
            <ol>
                <li>
                    <strong>Prepare the HUB75 cable</strong>
                    <ul>
                        <li>Use a 16-pin ribbon cable with IDC connectors, or</li>
                        <li>Use individual jumper wires following the pinout table above</li>
                    </ul>
                </li>
                <li>
                    <strong>Connect ESP32-S3 to matrix</strong>
                    <ul>
                        <li>Double-check pin alignment before connecting power</li>
                        <li>Connect all GND pins for stable operation</li>
                        <li>Keep wires as short as possible to reduce signal integrity issues</li>
                    </ul>
                </li>
                <li>
                    <strong>Connect power supply</strong>
                    <ul>
                        <li>Connect 5V power supply to matrix power input (usually screw terminals or barrel jack)</li>
                        <li>Power ESP32-S3 via USB-C or from the same 5V supply</li>
                        <li>Verify polarity: Red = +5V, Black = GND</li>
                    </ul>
                </li>
                <li>
                    <strong>Flash bootstrap firmware</strong>
                    <ul>
                        <li>Use esptool or PlatformIO to flash the bootstrap firmware</li>
                        <li>See instructions below</li>
                    </ul>
                </li>
                <li>
                    <strong>Initial setup</strong>
                    <ul>
                        <li>Power on - display should show "WEBEX DISPLAY"</li>
                        <li>Connect to WiFi AP "LED-Matrix-Setup"</li>
                        <li>Follow web-based setup wizard at 192.168.4.1</li>
                    </ul>
                </li>
            </ol>
        </section>

        <section>
            <h2>Flashing Firmware</h2>
            
            <h3>Option 1: Using esptool (Recommended for beginners)</h3>
            <div class="code-block">
                <code>
# Install esptool<br>
pip install esptool<br>
<br>
# Flash ESP32-S3 bootstrap firmware<br>
esptool.py --chip esp32s3 --port /dev/ttyUSB0 write_flash 0x0 bootstrap-esp32s3.bin<br>
<br>
# Flash ESP32 bootstrap firmware<br>
esptool.py --chip esp32 --port /dev/ttyUSB0 write_flash 0x0 bootstrap-esp32.bin
                </code>
            </div>

            <h3>Option 2: Using PlatformIO</h3>
            <div class="code-block">
                <code>
# Clone the repository<br>
git clone https://github.com/liptonj/Led-Matrix-Webex.git<br>
cd Led-Matrix-Webex/firmware_bootstrap<br>
<br>
# Upload to ESP32-S3<br>
pio run -e esp32s3 -t upload<br>
<br>
# Upload to ESP32<br>
pio run -e esp32 -t upload
                </code>
            </div>
        </section>

        <section>
            <h2>Troubleshooting</h2>
            
            <h3>üîç Display Issues</h3>
            <table>
                <thead>
                    <tr>
                        <th>Problem</th>
                        <th>Possible Cause</th>
                        <th>Solution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Blank display</td>
                        <td>Power not connected or FM6126A init failed</td>
                        <td>Check 5V supply to matrix. Verify firmware has <code>FM6126A</code> driver enabled</td>
                    </tr>
                    <tr>
                        <td>Display flickers</td>
                        <td>Poor ground connection or refresh rate issue</td>
                        <td>Connect all GND pins. Verify <code>clkphase = false</code> in code</td>
                    </tr>
                    <tr>
                        <td>Wrong colors</td>
                        <td>Swapped RGB data pins</td>
                        <td>Verify R1/G1/B1/R2/G2/B2 wiring matches pinout table</td>
                    </tr>
                    <tr>
                        <td>Garbled image</td>
                        <td>Clock or latch timing issues</td>
                        <td>Check CLK (GPIO 47) and LAT (GPIO 38) connections. Try reducing <code>i2sspeed</code> to HZ_10M</td>
                    </tr>
                    <tr>
                        <td>Dim display</td>
                        <td>Insufficient power or brightness setting</td>
                        <td>Use 4A power supply. Check brightness setting in web UI</td>
                    </tr>
                    <tr>
                        <td>Half display wrong</td>
                        <td>R2/G2/B2 wiring incorrect</td>
                        <td>Verify lower half data pins (R2, G2, B2)</td>
                    </tr>
                    <tr>
                        <td>Horizontal lines</td>
                        <td>Row select (A/B/C/D/E) wiring issue</td>
                        <td>Check address line connections</td>
                    </tr>
                </tbody>
            </table>

            <h3>üîå Connection Issues</h3>
            <ul>
                <li><strong>Can't connect to "LED-Matrix-Setup" WiFi:</strong> Hold reset button for 10 seconds to factory reset and restart AP mode</li>
                <li><strong>Captive portal doesn't open:</strong> Manually navigate to <code>http://192.168.4.1</code> in your browser</li>
                <li><strong>Device not responding after setup:</strong> Check if connected to WiFi. Find device at <code>http://led-matrix.local</code> or check your router for assigned IP</li>
            </ul>

            <h3>üåê Webex Connection Issues</h3>
            <ul>
                <li><strong>Webex auth fails:</strong> Verify client ID and client secret are correct. Check device has internet access</li>
                <li><strong>Status not updating:</strong> Check web interface logs. Verify Webex token hasn't expired</li>
                <li><strong>Bridge mode not connecting:</strong> Verify bridge server is running and reachable on network</li>
            </ul>
        </section>

        <section>
            <h2>Advanced: Custom PCB</h2>
            <p>For permanent installations, consider designing a custom PCB that:</p>
            <ul>
                <li>Directly accepts HUB75 IDC connector</li>
                <li>Has ESP32-S3 module soldered down</li>
                <li>Includes 5V power regulation</li>
                <li>Adds level shifters for signal integrity (optional)</li>
                <li>Includes mounting holes for enclosure</li>
            </ul>
            <p>PCB design files may be added to the GitHub repository in the future.</p>
        </section>

        <section>
            <h2>Need More Help?</h2>
            <p>Check out the additional documentation:</p>
            <ul>
                <li><a href="https://github.com/liptonj/Led-Matrix-Webex/tree/main/docs" target="_blank">Full Documentation</a> - Complete setup guides</li>
                <li><a href="https://github.com/liptonj/Led-Matrix-Webex/issues" target="_blank">GitHub Issues</a> - Report bugs or ask questions</li>
                <li><a href="https://github.com/liptonj/Led-Matrix-Webex/discussions" target="_blank">Discussions</a> - Community support</li>
                <li><a href="versions.html">Download Firmware</a> - Get the latest release</li>
            </ul>
        </section>
    </main>

    <footer>
        <div class="container">
            <p><a href="index.html">‚Üê Back to Home</a></p>
            <p>Open source project - MIT License</p>
        </div>
    </footer>

    <script src="js/main.js"></script>
</body>
</html>
