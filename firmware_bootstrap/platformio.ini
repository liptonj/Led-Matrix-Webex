; PlatformIO Project Configuration File
; ESP32 Webex Status Display - Bootstrap Firmware
;
; This is a minimal bootstrap firmware that handles:
; - WiFi provisioning (AP mode + SmartConfig)
; - OTA download of the full firmware from GitHub Releases
;
; Size target: < 500KB to leave room for OTA updates
;
; Build for ESP32-S3: pio run -e esp32s3
; Build for ESP32:    pio run -e esp32

; ==============================================================================
; Common settings
; ==============================================================================
[common]
lib_deps =
    ; JSON parsing
    bblanchon/ArduinoJson@^7.0.0
    ; Async Web Server
    me-no-dev/ESPAsyncWebServer@^1.2.3
    me-no-dev/AsyncTCP@^1.1.1

; ==============================================================================
; ESP32-S3 Environment
; ==============================================================================
[env:esp32s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; Board configuration for N8R2 variant (8MB Flash, 2MB PSRAM)
board_build.flash_size = 8MB
board_build.partitions = default_8MB.csv

; Build flags
build_flags =
    -DBOOTSTRAP_VERSION=\"1.0.1\"
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
    -DESP32_S3_BOARD=1
    ; Default OTA URL for GitHub releases
    -DDEFAULT_OTA_URL=\"https://api.github.com/repos/liptonj/Led-Matrix-Webex/releases/latest\"

; Upload settings
upload_speed = 921600
monitor_speed = 115200

; Libraries
lib_deps = ${common.lib_deps}

; File system for web assets
board_build.filesystem = littlefs

; Optimization for size
build_type = release

; ==============================================================================
; ESP32 (Standard) Environment
; ==============================================================================
[env:esp32]
platform = espressif32
board = esp32dev
framework = arduino

; Board configuration for standard ESP32 (4MB Flash)
board_build.flash_size = 4MB
board_build.partitions = default.csv

; Build flags
build_flags =
    -DBOOTSTRAP_VERSION=\"1.0.1\"
    -DESP32_STANDARD_BOARD=1
    ; Default OTA URL for GitHub releases
    -DDEFAULT_OTA_URL=\"https://api.github.com/repos/liptonj/Led-Matrix-Webex/releases/latest\"

; Upload settings
upload_speed = 921600
monitor_speed = 115200

; Libraries
lib_deps = ${common.lib_deps}

; File system for web assets
board_build.filesystem = littlefs

; Optimization for size
build_type = release
